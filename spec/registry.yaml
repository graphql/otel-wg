groups:
  - id: registry.graphql
    type: attribute_group
    display_name: GraphQL Attributes
    brief: "This document defines attributes for GraphQL operations and resolvers."
    attributes:
      - id: graphql.operation.name
        brief: "The name of the operation being executed."
        type: string
        stability: development
        examples: ["FindBookById", "GetUserProfile"]
        note: >
          This represents the operation name as specified in the GraphQL operation document.
          When the operation name is not provided, this attribute SHOULD be omitted.
      - id: graphql.operation.type
        brief: "The type of the operation being executed."
        stability: development
        type:
          members:
            - id: query
              value: "query"
              brief: "GraphQL query operation"
              stability: development
            - id: mutation
              value: "mutation"
              brief: "GraphQL mutation operation"
              stability: development
            - id: subscription
              value: "subscription"
              brief: "GraphQL subscription operation"
              stability: development
        examples: ["query", "mutation", "subscription"]
      - id: graphql.document.hash
        brief: "The hash of the operation document."
        type: string
        stability: development
        examples:
          [
            "sha256:400483f38c08e8a3d3b972409c9dfb8e4a326e1b1940864932acd9f873d8664c",
          ]
        note: >
          The hash algorithm used SHOULD be specified as part of the value (e.g., "sha256:...").
          This can be used for monitoring operation distribution and caching strategies.
      - id: graphql.document.id
        brief: >
          The document identifier for persisted operations.
        type: string
        stability: development
        examples: ["aa3e37c1bf54708e93f12c137afba004"]
        note: >
          This is a hash or identifier of the document provided by the user to identify
          persisted operations. This attribute SHOULD only be set when using persisted operations.
      - id: graphql.selection.name
        brief: "The name of the selection that is being resolved. Either the field name or an alias."
        type: string
        stability: development
        examples: ["newAddress", "bookTitle"]
        note: >
          If the field has an alias, this SHOULD be the alias name. Otherwise, it SHOULD be the field name.
      - id: graphql.selection.path
        brief: "The path of the selection that is being resolved."
        type: string
        stability: development
        examples: ["person[0].address"]
        note: >
          The path represents the location of the field being resolved within the result structure.
          Therefore, if a field is aliased, the path will use the alias name instead of the actual field name.
          
      - id: graphql.selection.field.name
        brief: "The name of the field that is being resolved."
        type: string
        stability: development
        examples: ["address", "name", "id"]
        note: >
          This is always the actual field name as defined in the schema, not an alias.
      - id: graphql.selection.field.parent_type
        brief: "The type that declares the field that is being resolved."
        type: string
        stability: development
        examples: ["Person", "Query", "Mutation"]
        note: >
          This is the GraphQL type name that contains the field definition.
      - id: graphql.selection.field.coordinate
        brief: "The coordinate of the field that is being resolved."
        type: string
        stability: development
        examples: ["Person.address", "Query.findBookById"]
        note: >
          The coordinate follows the format "{ParentType}.{fieldName}" and uniquely
          identifies the field within the GraphQL schema.

  - id: registry.graphql.error
    type: attribute_group
    display_name: GraphQL Error Attributes
    brief: >
      This document defines the shared attributes used to
      report GraphQL errors associated with a span or event.
    attributes:
      - id: graphql.error.message
        type: string
        stability: development
        brief: >
          The error message intended for the developer as a guide to understand and correct the
          error.
        examples:
          [
            "Cannot query field 'nonExistentField' on type 'User'",
            "Variable '$id' of required type 'ID!' was not provided.",
          ]
        note: >
          Every error must contain an entry with the key message with a string description of the
          error intended for the developer as a guide to understand and correct the error.

      - id: graphql.error.locations
        type: map[]
        stability: development
        brief: >
          The locations in the GraphQL document associated with the error.
        examples: ['[{"line":3,"column":7}]']
        note: >
          If an error can be associated to a particular point in the requested GraphQL document, it
          should contain an entry with the key locations with a list of locations, where each
          location is a map with the keys line and column, both positive numbers starting from 1
          which describe the beginning of an associated syntax element.

          This should be serialized as a JSON string array.
        fields:
          - id: line
            type: int
            stability: development
            brief: >
              The line number of the location in the GraphQL document.
            examples: [3]
            requirement_level: required
          - id: column
            type: int
            stability: development
            brief: >
              The column number of the location in the GraphQL document.
            examples: [7]
            requirement_level: required

      - id: graphql.error.path
        type: string[]
        stability: development
        brief: >
          The path of the response field which experienced the error.
        examples:
          ['["user", 1, "nonExistentField"]', '["query", "findBookById"]']
        note: >
          If an error can be associated to a particular field in the GraphQL result, it must contain
          an entry with the key path that details the path of the response field which experienced
          the error. 

          This allows clients to identify whether a null result is intentional or caused by a
          runtime error.

          This field should be a list of path segments starting at the root of the response and
          ending with the field associated with the error. Path segments that represent fields
          should be strings, and path segments that represent list indices should be 0-indexed
          integers. If the error happens in an aliased field, the path to the error should use the
          aliased name, since it represents a path in the response, not in the request.

      - id: graphql.error.extensions.code
        type: string
        stability: development
        brief: >
          An optional error code from the extensions field.
        examples: ["GRAPHQL_VALIDATION_FAILED", "UNAUTHENTICATED", "HC00116"]
        note: >
          This is an optional field that can be used to categorize errors. The error extension code 
          is a recommended way to categorize errors for easier filtering and monitoring.
      - id: graphql.operation.step.id
        brief: "The id of the step in the execution plan."
        type: string
        stability: development
        examples: ["0", "1", "2"]
      - id: graphql.operation.step.kind
        brief: "The kind of step in the execution plan."
        type: string
        stability: development
        examples: ["node", "operation", "fetch", "batch"]
      - id: graphql.operation.step.plan.id
        brief: "The id of the execution plan this step belongs to."
        type: string
        stability: development
        examples: ["plan-1", "abc-123"]
      - id: graphql.source.name
        brief: "The name of the source system."
        type: string
        stability: development
        examples: ["accounts", "products", "reviews"]
        note: >
          The human-readable name of the downstream source that a distributed
          GraphQL gateway dispatches to. For example, this could be a subgraph
          name in a federated system or a stitched schema name.
      - id: graphql.source.id
        brief: "The unique identifier of the source system."
        type: string
        stability: development
        examples: ["src-1", "abc-123", "https://accounts.example.com/graphql"]
        note: >
          An identifier for the downstream source system. The format is
          implementation-specific and can be any string.
      - id: graphql.source.operation.name
        brief: "The name of the GraphQL operation to be executed on the source."
        type: string
        stability: development
        examples: ["GetUser", "FetchProducts", "ResolveReviews"]
        note: >
          The operation name of the query or mutation that the gateway sends
          to the source system.
      - id: graphql.source.operation.kind
        brief: "The kind of GraphQL operation to be executed on the source."
        type: string
        stability: development
        examples: ["query", "mutation", "subscription"]
        note: >
          The kind of operation that the gateway sends to the source system.
      - id: graphql.source.operation.hash
        brief: "A hash of the GraphQL operation to be executed on the source."
        type: string
        stability: development
        examples: ["sha256:abc123", "md5:def456"]
        note: >
          A hash of the operation document that the gateway sends to the
          source system. Useful for identifying operations without transmitting
          the full document.
      - id: graphql.dataloader.name
        brief: "The name of the DataLoader instance."
        type: string
        stability: development
        examples: ["UserLoader", "ProductByIdLoader", "CommentsByPostIdLoader"]
        note: >
          This represents the name or identifier of the DataLoader instance.
          When the DataLoader implementation supports naming, this SHOULD be set.
          This helps in identifying specific DataLoader instances in observability.
      - id: graphql.dataloader.batch.size
        brief: "The number of individual requests in the DataLoader batch."
        type: int
        stability: development
        examples: [5, 12, 25]
        note: >
          This represents the total number of individual load requests that were
          batched together in a single batch operation. This includes both cache
          hits and cache misses.
      - id: graphql.dataloader.batch.keys
        brief: "A subset of the keys requested in the DataLoader batch."
        type: string[]
        stability: development
        examples: [["user:1", "user:2", "user:3"], ["post:42", "post:99"]]
        note: >
          This attribute is opt-in and SHOULD NOT be enabled by default, as keys
          may contain sensitive or high-cardinality data. When enabled, implementations
          MAY truncate the list to a configurable maximum number of keys.
          The string representation of each key depends on the DataLoader implementation.
      - id: graphql.dataloader.cache.hit_count
        brief: "The number of requests in the batch that were served from the DataLoader cache."
        type: int
        stability: development
        examples: [0, 3, 10]
        note: >
          This represents the number of individual load requests that were
          resolved from the DataLoader's cache without requiring a fetch.
      - id: graphql.dataloader.cache.miss_count
        brief: "The number of requests in the batch that required fetching."
        type: int
        stability: development
        examples: [2, 5, 12]
        note: >
          This represents the number of individual load requests that were
          not found in the DataLoader's cache and required a fetch operation.
